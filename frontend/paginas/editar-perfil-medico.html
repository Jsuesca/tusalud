<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar Perfil Médico</title>
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <div class="form-wrapper">
    <h2>Editar Mi Perfil</h2>
    <form id="formEditar"></form>
    <button id="btnGuardar" class="btn-guardar">Guardar Cambios</button>
  </div>

  <script>
    const form = document.getElementById("formEditar");
    const medicoId = localStorage.getItem("medicoId");

    async function cargarPerfil() {
      const res = await fetch(`http://localhost:5000/api/medicos/perfil/${medicoId}`);
      const medico = await res.json();

      form.innerHTML = `
        <label>Nombre:</label>
        <input name="nombre" value="${medico.nombre}">
        <label>Especialidad:</label>
        <input name="especialidad" value="${medico.especialidad}">
        <label>Experiencia:</label>
        <input name="experiencia" value="${medico.experiencia}">
        <label>Descripción:</label>
        <textarea name="descripcion">${medico.descripcion}</textarea>
        <label>Horario:</label>
        <input name="horario" value="${medico.horario}">
        <label>Correo:</label>
        <input name="correo" value="${medico.correo}">
        <label>Teléfono:</label>
        <input name="telefono" value="${medico.telefono}">
      `;
    }

    cargarPerfil();

    document.getElementById("btnGuardar").addEventListener("click", async () => {
      const datos = Object.fromEntries(new FormData(form).entries());
      const res = await fetch(`http://localhost:5000/api/medicos/${medicoId}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
      });

      const data = await res.json();
      alert(data.mensaje);
    });
  </script>
</body>
</html>

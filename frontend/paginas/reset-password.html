<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restablecer ContraseÃ±a</title>

    <link rel="stylesheet" href="../css/styles.css">
</head>

<body class="reset-body">

    <div class="reset-container">
        <h2>Restablecer ContraseÃ±a ğŸ”</h2>
        <p>Ingresa tu nueva contraseÃ±a para continuar</p>

        <input type="password" id="newPass" class="reset-input" placeholder="Nueva contraseÃ±a">

        <button onclick="resetPassword()" class="reset-btn">Guardar contraseÃ±a</button>

        <p id="estado" class="estado-text"></p>
    </div>

<script>
async function resetPassword(){
    const estado = document.getElementById("estado");
    const nueva = document.getElementById("newPass").value.trim();

    if(nueva.length < 6){
        estado.className = "estado-text error";
        estado.textContent = "âš  La contraseÃ±a debe tener mÃ­nimo 6 caracteres.";
        return;
    }

    const token = new URLSearchParams(location.search).get("token");

    // âœ… RUTA CORREGIDA
    const res = await fetch(`http://localhost:5000/api/password/reset-password/${token}`, {
        method: "POST",
        headers:{ "Content-Type": "application/json" },
        body: JSON.stringify({ newPassword: nueva })
    });

    const data = await res.json();

    estado.className = res.ok ? "estado-text success" : "estado-text error";
    estado.textContent = data.mensaje;

    if(res.ok){
        setTimeout(()=>{ window.location.href="login.html"; },2000);
    }
}
</script>

</body>
</html>
